---
title: "Progress Memo 2"
subtitle: |
  | Final Project 
  | Data Science 1 with R (STAT 301-1)
author: "Ada Liu"
date: today

format:
  html:
    toc: true
    embed-resources: true
    
execute:
  echo: false
  warning: false

from: markdown+emoji 
---

::: {.callout-tip icon=false}

## Github Repo Link

[https://github.com/stat301-1-2023-fall/final-project-1-adacliu.git](https://github.com/stat301-1-2023-fall/final-project-1-adacliu.git)

:::
```{r}
#| echo: false
library(tidyverse)
eda_data <- read_csv("data/eda_data.csv")
```


::: {.callout-tip icon="false"}
## Data Collecting and Cleaning

For my EDA, I decided on using only the two datasets I mentioned in my first progress meme, the Global Terrorism Database and the Polity IV dataset as I found them comprehensive and included a variety of variables. I did my data cleaning in my 0b_data_cleaning .R file, which included removing variables from both datasets that had huge missingness issue, in my case, over 50% missing. Since the earliest entry in the Polity dataset was 1776 and the latest entry in the GTD was 2017, I dropped any entries prior to 1776 from the GTD dataset and any entries after 2017 in the Polity dataset. Further, I changed some of the column names (ie, "country_txt" to "country_name") in the datasets to facilitate merging. I used the compound key "country_name" and "year" from the Polity dataset to join the two datasets and then cleaned up this new, combined dataset by removing any variables that I was not interested in working with and changed unknown values to "NA". I decided to keep 41 variables in my final dataset, giving me a wide variety of variables to work with and explore.  Finally, I created text file codebook to document what each variable is. 
 
:::

::: {.callout-tip icon="false"}
## Data overview and quality

After I combined and cleaned my two raw datasets, the dataset I will be using for my EDA has 43 variables and very little missingness issues. There are 11 categorical variables and 30 numerical variables with 175,790 observations. 
:::
```{r}
#| echo: false
eda_data |>
  ggplot(aes(x = year))+
  geom_histogram(fill = "skyblue")+
  labs(title = "Distribution of Terroist Attacks by Year",
       x = "Year", y = "Count")
```

I found the data about weapons very interesting

```{r}
#| echo: false
eda_data |>
  filter(exrec > -11) |>
  mutate(exrec = as.factor(exrec)) |>
  ggplot(aes(x = exrec))+
  geom_bar(fill = "hotpink") +
  labs(title = "Distribution of Terroist Attacks by Executive Recruitment Score",
       x = "Executive Recruitment Score", y = "Count")
```




```{r}
#| echo: false
eda_data |>
  mutate(success = as.factor(success)) |>
  ggplot(aes(x = weaptype1_txt, fill = success))+
  geom_bar()+
  facet_wrap(~weaptype1_txt, scales = "free") +
  labs(title = "Success Rate of Terroist Attacks by Weapon Type",
       x = "Weapon Type", y = "Count")+
  scale_fill_manual(values = c("0" = "hotpink", "1" = "skyblue"),
                       labels = c("Unsuccessful", "Sucessful"))
```

```{r}
eda_data <- eda_data |>
  mutate(year_category = case_when(
    year >= 1970 & year <= 1979 ~ '1970-1979',
    year >= 1980 & year <= 1989 ~ '1980-1989',
    year >= 1990 & year <= 1999 ~ '1990-1999',
    year >= 2000 & year <= 2009 ~ '2000-2009',
    year >= 2010 & year <= 2017 ~ '2010-2017'
  ))
```

```{r}
eda_data |>
  mutate(killed_wounded = nkill + nwound) |>
  ggplot(aes(x = year_category, y = killed_wounded))+
  geom_boxplot() +
  coord_flip()
```
most terrorist attacks do not kill over 1000 people with a few rare exoections killing over 4000

```{r}
eda_data |>
  mutate(killed_wounded = nkill + nwound) |>
  filter(killed_wounded < 2500) |>
  ggplot(aes(x = year_category, y = killed_wounded))+
  geom_boxplot() +
  coord_flip()
```
```{r}
eda_data |>
  mutate(killed_wounded = nkill + nwound) |>
  summarise(avg_kill = mean(nkill, na.rm = TRUE),
            avg_wound = mean(nwound, na.rm = TRUE),
            avg_kill_wound = mean(killed_wounded, na.rm = TRUE))
```
```{r}
eda_data |>
  mutate(killed_wounded = nkill + nwound) |>
  group_by(weaptype1_txt) |>
  summarise(avg_kill = mean(nkill, na.rm = TRUE),
            avg_wound = mean(nwound, na.rm = TRUE),
            avg_kill_wound = mean(killed_wounded, na.rm = TRUE)) |>
  arrange(desc(avg_kill_wound))
```



